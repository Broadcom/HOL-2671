# Version 1

ltm node /Common/k8sworker-01a {
    address 172.16.110.11
    description k8sworker-01a
}
ltm node /Common/k8sworker-02a {
    address 172.16.110.12
    description k8sworker-02a
}
ltm pool /Common/hol-basic-pool-1 {
    load-balancing-mode least-connections-member
    members {
        /Common/k8sworker-01a:30001 {
            address 172.16.110.11
            description k8sworker-01a
        }
        /Common/k8sworker-02a:30001 {
            address 172.16.110.12
            description k8sworker-02a
        }
    }
    monitor /Common/http_hol 
}
ltm pool /Common/hol-basic-pool-2 {
    load-balancing-mode least-connections-member
    members {
        /Common/k8sworker-01a:30001 {
            address 172.16.110.11
            description k8sworker-01a
        }
        /Common/k8sworker-02a:30001 {
            address 172.16.110.12
            description k8sworker-02a
        }
    }
    monitor /Common/http_hol 
}
ltm pool /Common/hol-basic-pool-3 {
    load-balancing-mode least-connections-member
    members {
        /Common/k8sworker-01a:30001 {
            address 172.16.110.11
            description k8sworker-01a
        }
        /Common/k8sworker-02a:30001 {
            address 172.16.110.12
            description k8sworker-02a
        }
    }
    monitor /Common/tcp
}
ltm pool /Common/hol-basic-pool-4 {
    load-balancing-mode least-connections-member
    members {
        /Common/k8sworker-01a:30001 {
            address 172.16.110.11
            description k8sworker-01a
        }
        /Common/k8sworker-02a:30001 {
            address 172.16.110.12
            description k8sworker-02a
        }
    }
    monitor /Common/tcp
}
ltm pool /Common/hol-basic-pool-5 {
    load-balancing-mode least-connections-member
    members {
        /Common/k8sworker-01a:30001 {
            address 172.16.110.11
            description k8sworker-01a
        }
        /Common/k8sworker-02a:30001 {
            address 172.16.110.12
            description k8sworker-02a
        }
    }
    monitor /Common/http_hol
}
ltm persistence cookie /Common/cookie-vmware {
    app-service none
    defaults-from /Common/cookie
    expiration 2:0:0
}
ltm persistence source-addr /Common/source_addr {
    app-service none
    defaults-from /Common/source_addr
    match-across-services enabled
}
ltm virtual-address /Common/172.16.130.130 {
    address 172.16.130.130
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/172.16.130.131 {
    address 172.16.130.131
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/172.16.130.132 {
    address 172.16.130.132
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/172.16.130.133 {
    address 172.16.130.133
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual-address /Common/172.16.130.134 {
    address 172.16.130.134
    arp enabled
    icmp-echo enabled
    mask 255.255.255.255
    traffic-group /Common/traffic-group-1
}
ltm virtual /Common/hol-1-basic-http-vs-80 {
    destination /Common/172.16.130.130:80
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/cookie-vmware {
            default yes
        }
    }
    pool /Common/hol-basic-pool-1
    profiles {
        /Common/http { }
        /Common/tcp { }
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/hol-2-basic-http-vs-443 {
    destination /Common/172.16.130.131:443
    ip-protocol tcp
    mask 255.255.255.255
    pool /Common/hol-basic-pool-2
    profiles {
        /Common/http { }
        /Common/tcp { }
        /Common/client_ssl_profile {
            context clientside
        }
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/hol-3-basic-tcp-vs-8080 {
    destination /Common/172.16.130.132:8080
    ip-protocol tcp
    mask 255.255.255.255
    persist {
        /Common/source_addr {
            default yes
        }
    }
    pool /Common/hol-basic-pool-3
    profile {
        /Common/tcp { }
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/hol-4-basic-tcp-vs-443 {
    destination /Common/172.16.130.133:443
    ip-protocol tcp
    mask 255.255.255.255
    pool /Common/hol-basic-pool-4
    profiles {
        /Common/tcp { }
        /Common/client_ssl_profile {
            context clientside
        }
    }
    translate-address enabled
    translate-port enabled
}
ltm virtual /Common/hol-5-basic-vs {
    destination /Common/172.16.130.134:80
    ip-protocol tcp
    mask 255.255.255.255
    pool /Common/hol-basic-pool-5
    profiles {
        /Common/http { }
        /Common/tcp { }
    }
    translate-address enabled
    translate-port enabled
}
ltm profile client-ssl /Common/client_ssl_profile {
    app-service none
    cert /Common/client_ssl_cert.crt
    cert-key-chain {
        client_ssl_cert_key_chain {
            cert /Common/client_ssl_cert.crt
            chain /Common/client_ssl_cert_chain.crt
            key /Common/client_ssl_key.key
        }
    }
    chain /Common/client_ssl_cert_chain.crt
    ciphers DEFAULT:!TLSV1:!TLSV1_1:!3DES
    defaults-from /Common/clientssl
    inherit-certkeychain false
    key /Common/client_ssl_key.key
    passphrase none
}
ltm monitor http /Common/http_hol {
    adaptive disabled
    defaults-from /Common/http
    destination *:30001
    interval 5
    ip-dscp 0
    recv none
    recv-disable none
    send "GET / HTTP/1.0\r\n\r\n"
    time-until-up 0
    timeout 16
}